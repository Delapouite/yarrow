!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3-selection")):"function"==typeof define&&define.amd?define(["exports","d3-selection"],e):e(t.yarrow=t.yarrow||{},t.d3_selection)}(this,function(t,e){"use strict";var n=function(){var t={},e=[];return t.arrow=function(t,n){n=n||document.body;var a=new r(this,t,n);return e.push(a),a},t.remove=function(t){for(var n=-1,r=e.length;n++<r;)if(e[n].id===t)return e.splice(n,1)},t},r=function(t,n,r){var o,s={},i=new a,d="id"+Math.random().toString(36).substr(2,10),f=e.select(r),l=n.duration||300,u=n.delay||0,p=n.d||function(t,e){return e.m(t.dx>0?0:Math.abs(t.dx),t.dy>0?0:Math.abs(t.dy))+e.l(t.dx>0?t.dx:0,t.dy>0?t.dy:0)},c=n.duration1||200,y=n.delay1||l+u,h=n.d1||function(t,e){return e.m(0,0)+e.l(-20,-10)},x=n.duration2||c,m=n.delay||l+u,v=n.d2||function(t,e){return e.m(0,0)+e.l(-20,10)},g=n.text,w=("function"==typeof n.textReverseDirection?n.textReverseDirection(n,i):n.textReverseDirection)||!1,k=("function"==typeof n.textStartOffset?n.textStartOffset(n,i,w):n.textStartOffset)||0,M=n.textDx||0,b=n.textDy||-5,_={top:20,right:20,bottom:20,left:20},L=Math.abs(n.dx),T=Math.abs(n.dy),D=Math.min(n.y,n.y+n.dy)-_.top,j=Math.min(n.x,n.x+n.dx)-_.left,O=L+_.left+_.right,P=T+_.top+_.bottom;return s.id=d,s.render=function(){o=f.append("svg").attrs({id:d,"xmlns:xlink":"http://www.w3.org/1999/xlink","xml:space":"preserve","class":"yarrow",viewBox:"0 0 "+O+" "+P+" ",width:O+"px",height:P+"px"}).styles({top:D+"px",left:j+"px"});var t=o.append("g").attrs({transform:"translate("+_.left+","+_.top+")"}),e=t.append("path").attrs({id:"path_"+d,"stroke-linecap":"round","stroke-linejoin":"round","class":"arrow",d:"function"==typeof p?p(n,i):p}),r=e.node().getTotalLength(),a=e.node().getPointAtLength(r-1),s=e.node().getPointAtLength(r),L=i.angle(a,s);e.styles({"animation-duration":l/1e3+"s","animation-delay":u/1e3+"s","stroke-dasharray":r+" "+r,"stroke-dashoffset":r});var T=t.append("path").attrs({"stroke-linecap":"round","stroke-linejoin":"round","class":"arrow tip-1",d:"function"==typeof h?h(n,i):h,transform:"translate("+s.x+","+s.y+")rotate("+L+")"}),S=T.node().getTotalLength();T.styles({"animation-duration":c/1e3+"s","animation-delay":y/1e3+"s","stroke-dasharray":S+" "+S,"stroke-dashoffset":S});var A=t.append("path").attrs({"stroke-linecap":"round","stroke-linejoin":"round","class":"arrow tip-2",d:"function"==typeof v?v(n,i):v,transform:"translate("+s.x+","+s.y+")rotate("+L+")"}),R=A.node().getTotalLength();A.styles({"animation-duration":x/1e3+"s","animation-delay":m/1e3+"s","stroke-dasharray":R+" "+R,"stroke-dashoffset":R});var q=(t.append("path").attrs({id:"path_reverse_"+d,d:("function"==typeof p?p(n,i):p)+" z"}),t.append("text").attrs({"class":"arrow text",dx:M,dy:b})),z=q.append("textPath").attrs({"xlink:href":w?"#path_reverse_"+d:"#path_"+d,startOffset:w?2*r-k:k}).styles({opacity:0}).text(g);return setTimeout(function(){z.styles({transition:"all "+l/1e3+"s linear",opacity:1})},10),this},s.dispose=function(e,n){function r(t,e){return e?(t.selectAll(".arrow").styles({transition:"all "+e/1e3+"s linear",opacity:0}),void setTimeout(function(){return t.remove()},e)):t.remove()}var a=f.select("#"+d);t.remove(d),n?setTimeout(function(){r(a,e)},n):r(a,e)},s},a=function(){var t={};return t.m=function(t,e){return"M"+t+","+e+" "},t.l=function(t,e){return"L"+t+","+e+" "},t.angle=function(t,e){return 180*Math.atan2(e.y-t.y,e.x-t.x)/Math.PI},t};t.Yarrow=n});